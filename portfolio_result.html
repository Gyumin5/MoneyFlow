
    <!DOCTYPE html>
    <html lang="ko">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Cap Defend V9 í¬íŠ¸í´ë¦¬ì˜¤ (Fusion)</title>
        <style>
            body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; margin: 20px; background-color: #f9f9f9; color: #333; line-height: 1.6; }
            .container { max-width: 900px; margin: auto; background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
            h1, h2, h3, h4, h5 { color: #27ae60; border-bottom: 1px solid #eaecef; padding-bottom: 10px; }
            h1 { font-size: 2em; margin-bottom: 0; }
            h2.subtitle { font-size: 1.2em; color: #888; border: none; margin-top: 5px; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; margin-bottom: 20px; font-size: 0.9em; }
            th, td { padding: 8px; border: 1px solid #ddd; text-align: left; }
            th { background-color: #f2f2f2; }
            .final-table th { background-color: #27ae60; color: white; }
            .footer { margin-top: 20px; font-size: 0.9em; color: #888; text-align: center; }
            p { margin: 10px 0; }
            .error { color: #e74c3c; }
            .small-table table { width: auto; }
            .dataframe { border-collapse: collapse; width: auto; margin-bottom: 15px; }
            .dataframe th, .dataframe td { padding: 5px 8px; border: 1px solid #ccc; text-align: right; }
            .dataframe thead th { background-color: #f2f2f2; text-align: center; }
            .calculator-container { background-color: #f8f9fa; border: 1px solid #e9ecef; padding: 20px; margin-top: 30px; border-radius: 8px; }
            .calculator-container input[type="text"], .calculator-container input[type="number"] { width: 95%; padding: 8px; margin-right: 10px; border: 1px solid #ccc; border-radius: 4px; }
            .calculator-container button { padding: 8px 15px; background-color: #27ae60; color: white; border: none; border-radius: 4px; cursor: pointer; }
            .calculator-container button:hover { background-color: #229954; }
            #my-turnover-result-container { margin-top: 20px; padding: 15px; background-color: #e8f8f5; border: 1px solid #a9dfbf; border-radius: 5px; }
        </style>
    </head>
    <body>
        <div class="container">
            <h1>ğŸ† Cap Defend V9 í¬íŠ¸í´ë¦¬ì˜¤</h1>
            <h2 class="subtitle">(2025ë…„ 12ì›” 30ì¼ ê¸°ì¤€)</h2>
            <p><b>ì£¼ì‹ ì „ëµ (V3) ìƒíƒœ:</b> Attack</p>
            <p><b>ì½”ì¸ ì „ëµ (V4) ìƒíƒœ:</b> Risk-Off</p>
            <table class="final-table">
                <thead><tr><th>ì¢…ëª©</th><th>ìì‚°êµ°</th><th>ìµœì¢… ë¹„ì¤‘</th></tr></thead>
                <tbody>
                    <tr><td>Cash</td><td>í˜„ê¸ˆ</td><td>40.00%</td></tr><tr><td>GLD</td><td>ì£¼ì‹</td><td>15.00%</td></tr><tr><td>VEA</td><td>ì£¼ì‹</td><td>15.00%</td></tr><tr><td>EEM</td><td>ì£¼ì‹</td><td>15.00%</td></tr><tr><td>VT</td><td>ì£¼ì‹</td><td>15.00%</td></tr>
                </tbody>
                <tfoot><tr style="font-weight: bold;"><td colspan="2">ì´ í•©ê³„</td><td>100.00%</td></tr></tfoot>
            </table>

            <div class="calculator-container">
                <h3>ğŸ§® ì´ ìì‚° ë°°ë¶„ ê³„ì‚°ê¸°</h3>
                <p>ì´ íˆ¬ì ì˜ˆì • ê¸ˆì•¡(ì›)ì„ ì…ë ¥í•˜ì‹œë©´ ê° ìì‚°ì— ì–¼ë§ˆì”© ë°°ë¶„í•´ì•¼ í•˜ëŠ”ì§€ ê³„ì‚°í•©ë‹ˆë‹¤.</p>
                <input type="number" id="total-assets-input" placeholder="ì´ ìì‚°ì•¡ (ì›)" min="0">
                <button id="calculate-total">ê³„ì‚°í•˜ê¸°</button>
                <div id="total-assets-results" style="margin-top: 15px;"></div>
            </div>

            <div class="calculator-container">
                <h3>ğŸª™ ì½”ì¸ ìì‚° ë°°ë¶„ ê³„ì‚°ê¸°</h3>
                <p>ì½”ì¸ì—ë§Œ íˆ¬ìí•  ì´ ê¸ˆì•¡(ì›)ì„ ì…ë ¥í•˜ì‹œë©´ ì½”ì¸ê³¼ í˜„ê¸ˆì˜ ë°°ë¶„ ê¸ˆì•¡ì„ ê³„ì‚°í•©ë‹ˆë‹¤.</p>
                <input type="number" id="coin-assets-input" placeholder="ì½”ì¸ ì´ ìì‚°ì•¡ (ì›)" min="0">
                <button id="calculate-coin">ê³„ì‚°í•˜ê¸°</button>
                <div id="coin-assets-results" style="margin-top: 15px;"></div>
            </div>

            <h2>ğŸ”„ ì½”ì¸ í¬íŠ¸í´ë¦¬ì˜¤ í„´ì˜¤ë²„ ë¶„ì„ (ì¶”ì²œ í¬íŠ¸í´ë¦¬ì˜¤ ê°„)</h2>
            <p>ì–´ì œ(2025-12-28)ì™€ ì˜¤ëŠ˜(2025ë…„ 12ì›” 30ì¼) ì½”ì¸ í¬íŠ¸í´ë¦¬ì˜¤ ê°„ì˜ í„´ì˜¤ë²„ ë¹„ìœ¨: <b>0.00%</b></p>

            <hr>

            <div class="calculator-container">
                <h1>ğŸª™ ë‚´ í¬íŠ¸í´ë¦¬ì˜¤ í„´ì˜¤ë²„ ê³„ì‚°ê¸°</h1>
                <p>í˜„ì¬ ë³´ìœ í•˜ê³  ê³„ì‹  ì½”ì¸ê³¼ í˜„ê¸ˆ ë³´ìœ ì•¡ì„ ì›í™”(KRW) ê¸°ì¤€ìœ¼ë¡œ ì…ë ¥í•˜ì‹œë©´, ì¶”ì²œ í¬íŠ¸í´ë¦¬ì˜¤ì™€ì˜ í„´ì˜¤ë²„ë¥¼ ê³„ì‚°í•´ ë“œë¦½ë‹ˆë‹¤.</p>
                
                <h2>1. ë‚´ ë³´ìœ ìì‚° ì…ë ¥</h2>
                <table id="my-portfolio-table">
                    <thead>
                        <tr>
                            <th>ìì‚° (ì˜ˆ: BTC, ETH, Cash)</th>
                            <th>ë³´ìœ ì•¡ (ì›)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td><input type="text" class="ticker-input" placeholder="ì½”ì¸ í‹°ì»¤ ë˜ëŠ” Cash"></td><td><input type="number" class="amount-input" placeholder="ë³´ìœ ì•¡ (ì›)" min="0"></td></tr><tr><td><input type="text" class="ticker-input" placeholder="ì½”ì¸ í‹°ì»¤ ë˜ëŠ” Cash"></td><td><input type="number" class="amount-input" placeholder="ë³´ìœ ì•¡ (ì›)" min="0"></td></tr><tr><td><input type="text" class="ticker-input" placeholder="ì½”ì¸ í‹°ì»¤ ë˜ëŠ” Cash"></td><td><input type="number" class="amount-input" placeholder="ë³´ìœ ì•¡ (ì›)" min="0"></td></tr><tr><td><input type="text" class="ticker-input" placeholder="ì½”ì¸ í‹°ì»¤ ë˜ëŠ” Cash"></td><td><input type="number" class="amount-input" placeholder="ë³´ìœ ì•¡ (ì›)" min="0"></td></tr><tr><td><input type="text" class="ticker-input" placeholder="ì½”ì¸ í‹°ì»¤ ë˜ëŠ” Cash"></td><td><input type="number" class="amount-input" placeholder="ë³´ìœ ì•¡ (ì›)" min="0"></td></tr><tr><td><input type="text" class="ticker-input" placeholder="ì½”ì¸ í‹°ì»¤ ë˜ëŠ” Cash"></td><td><input type="number" class="amount-input" placeholder="ë³´ìœ ì•¡ (ì›)" min="0"></td></tr>
                    </tbody>
                </table>
                <button id="calculate-my-turnover">ë‚´ í„´ì˜¤ë²„ ê³„ì‚°í•˜ê¸°</button>

                <div id="my-turnover-result-container" style="display:none;">
                    <h2>2. ê³„ì‚° ê²°ê³¼</h2>
                    <div id="my-turnover-result"></div>
                </div>
            </div>

            <hr>
            <h1>ğŸ“œ ìƒì„¸ ì‹¤í–‰ ë¡œê·¸</h1>
            <h2>ğŸ›°ï¸ Step 1: Coin Universe (Top 30 Cap)</h2><p>Selected 10 coins from Top 30: ['BTC-USD', 'ETH-USD', 'XRP-USD', 'SOL-USD', 'TRX-USD', 'DOGE-USD', 'ADA-USD', 'BCH-USD', 'LINK-USD', 'XLM-USD']</p><h2>ğŸ“¥ Step 2: Downloading Data</h2><h2>ğŸš€ Step 3: ì „ëµ ì‹¤í–‰ ë° í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„</h2><h2>ğŸ“ˆ Stock Strategy V3 (Global Balanced) - 60%</h2><p><b>[Canary] âœ… Risk-On (Attack)</b>: SPY/EEM Dual SMA Bullish</p><h5>- [ì„¸ë¶€] ê³µê²© ëª¨ë“œ íŒ©í„° ì ìˆ˜:</h5><table border="1" class="dataframe dataframe small-table">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Momentum</th>
      <th>Quality</th>
    </tr>
    <tr>
      <th>Ticker</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>SPY</th>
      <td>0.087119</td>
      <td>2.142060</td>
    </tr>
    <tr>
      <th>QQQ</th>
      <td>0.093130</td>
      <td>1.700869</td>
    </tr>
    <tr>
      <th>EFA</th>
      <td>0.118961</td>
      <td>1.672085</td>
    </tr>
    <tr>
      <th>EEM</th>
      <td>0.128529</td>
      <td>2.168022</td>
    </tr>
    <tr>
      <th>VT</th>
      <td>0.098238</td>
      <td>2.172238</td>
    </tr>
    <tr>
      <th>VEA</th>
      <td>0.141501</td>
      <td>2.141710</td>
    </tr>
    <tr>
      <th>GLD</th>
      <td>0.287924</td>
      <td>2.803302</td>
    </tr>
    <tr>
      <th>PDBC</th>
      <td>0.049363</td>
      <td>1.070108</td>
    </tr>
    <tr>
      <th>QUAL</th>
      <td>0.073250</td>
      <td>1.961789</td>
    </tr>
    <tr>
      <th>MTUM</th>
      <td>0.055950</td>
      <td>0.885944</td>
    </tr>
    <tr>
      <th>IQLT</th>
      <td>0.094322</td>
      <td>1.212083</td>
    </tr>
    <tr>
      <th>IMTM</th>
      <td>0.117843</td>
      <td>1.605800</td>
    </tr>
  </tbody>
</table><p>- ìµœì¢… ì£¼ì‹ í¬íŠ¸í´ë¦¬ì˜¤: ['GLD', 'VEA', 'EEM', 'VT']</p>
            <h3>ì˜¤ëŠ˜ ì½”ì¸ í¬íŠ¸í´ë¦¬ì˜¤ ìƒì„¸ ë¡œê·¸ (2025ë…„ 12ì›” 30ì¼)</h3>
            <h3>Coin Strategy V4 (Aggressive Alpha) (Date: 2025-12-30)</h3><h4>1. ì¹´ë‚˜ë¦¬ ì‹ í˜¸ í™•ì¸</h4><p>- BTC ê¸°ì¤€(ì¢…ê°€ 2025-12-30): $87,777.20 | 50ì¼ MA: $90,503.34</p><p>- [ë°ì´í„° ì§„ë‹¨] ì‚¬ìš©ê°€ëŠ¥ ë°ì´í„° ìˆ˜: 500ê°œ</p><p><b>- [ê²°ê³¼] ğŸš¨ ì•½ì„¸ì¥. ì½”ì¸ ë¹„ì¤‘ì„ 'Cash'ìœ¼ë¡œ ì „í™˜í•©ë‹ˆë‹¤.</b></p>
            <h3>ì–´ì œ ì½”ì¸ í¬íŠ¸í´ë¦¬ì˜¤ ìƒì„¸ ë¡œê·¸ (2025-12-28)</h3>
            <h3>Coin Strategy V4 (Aggressive Alpha) (Date: 2025-12-28)</h3><h4>1. ì¹´ë‚˜ë¦¬ ì‹ í˜¸ í™•ì¸</h4><p>- BTC ê¸°ì¤€(ì¢…ê°€ 2025-12-28): $87,835.84 | 50ì¼ MA: $90,842.19</p><p>- [ë°ì´í„° ì§„ë‹¨] ì‚¬ìš©ê°€ëŠ¥ ë°ì´í„° ìˆ˜: 499ê°œ</p><p><b>- [ê²°ê³¼] ğŸš¨ ì•½ì„¸ì¥. ì½”ì¸ ë¹„ì¤‘ì„ 'Cash'ìœ¼ë¡œ ì „í™˜í•©ë‹ˆë‹¤.</b></p>

            <div class="footer">ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: 2025ë…„ 12ì›” 30ì¼ 17:27:48 KST</div>
        </div>
        <script>
            const finalPortfolio = {"Cash": 0.4, "GLD": 0.15, "VEA": 0.15, "EEM": 0.15, "VT": 0.15};
            const coinStrategyPortfolio = {"Cash": 1.0};
            const symbolToTickerMap = {};
            const assetPrices = {"GLD": 572847.9987716675, "EEM": 78554.61878070832, "VT": 204089.66360549929, "VEA": 90138.04975433351};

            function formatKRW(num) {
                return new Intl.NumberFormat('ko-KR').format(num) + ' ì›';
            }

            document.getElementById('calculate-total').addEventListener('click', function() {
                const totalValue = parseFloat(document.getElementById('total-assets-input').value);
                const resultsDiv = document.getElementById('total-assets-results');
                if (isNaN(totalValue) || totalValue <= 0) {
                    resultsDiv.innerHTML = '<p style="color:red;">ìœ íš¨í•œ ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš”.</p>';
                    return;
                }
                
                let tableHtml = '<table class="small-table"><thead><tr><th>ì¢…ëª©</th><th>ì˜ˆìƒ ë°°ë¶„ ê¸ˆì•¡</th><th>ê¸°ì¤€ ë‹¨ê°€(ì›)</th><th>ì˜ˆìƒ ìˆ˜ëŸ‰</th></tr></thead><tbody>';
                const sortedItems = Object.entries(finalPortfolio).sort(([,a],[,b]) => b-a);
                for (const [ticker, weight] of sortedItems) {
                    const amount = totalValue * weight;
                    let quantity = '-';
                    let priceStr = '-';
                    if (ticker !== 'Cash' && assetPrices[ticker]) {
                        const price = assetPrices[ticker];
                        priceStr = formatKRW(Math.round(price));
                        const num_units = amount / price;
                        if (num_units < 10) {
                            quantity = num_units.toFixed(4);
                        } else {
                            quantity = num_units.toFixed(2);
                        }
                    }
                    tableHtml += `<tr><td>${ticker}</td><td>${formatKRW(Math.round(amount))}</td><td>${priceStr}</td><td>${quantity}</td></tr>`;
                }
                tableHtml += '</tbody></table>';
                resultsDiv.innerHTML = tableHtml;
            });

            document.getElementById('calculate-coin').addEventListener('click', function() {
                const totalValue = parseFloat(document.getElementById('coin-assets-input').value);
                const resultsDiv = document.getElementById('coin-assets-results');
                if (isNaN(totalValue) || totalValue <= 0) {
                    resultsDiv.innerHTML = '<p style="color:red;">ìœ íš¨í•œ ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš”.</p>';
                    return;
                }

                let tableHtml = '<table class="small-table"><thead><tr><th>ìì‚°</th><th>ì˜ˆìƒ ë°°ë¶„ ê¸ˆì•¡</th><th>ê¸°ì¤€ ë‹¨ê°€(ì›)</th><th>ì˜ˆìƒ ìˆ˜ëŸ‰</th></tr></thead><tbody>';
                const sortedItems = Object.entries(coinStrategyPortfolio).sort(([,a],[,b]) => b-a);
                for (const [ticker, weight] of sortedItems) {
                    const amount = totalValue * weight;
                    let quantity = '-';
                    let priceStr = '-';
                    if (ticker !== 'Cash' && assetPrices[ticker]) {
                        const price = assetPrices[ticker];
                        priceStr = formatKRW(Math.round(price));
                        const num_units = amount / price;
                        if (num_units < 10) {
                            quantity = num_units.toFixed(4);
                        } else {
                            quantity = num_units.toFixed(2);
                        }
                    }
                    tableHtml += `<tr><td>${ticker}</td><td>${formatKRW(Math.round(amount))}</td><td>${priceStr}</td><td>${quantity}</td></tr>`;
                }
                tableHtml += '</tbody></table>';
                resultsDiv.innerHTML = tableHtml;
            });

            document.getElementById('calculate-my-turnover').addEventListener('click', function() {
                const myPortfolio = {};
                let totalValue = 0;
                const rows = document.querySelectorAll('#my-portfolio-table tbody tr');
                
                rows.forEach(row => {
                    const tickerInput = row.querySelector('.ticker-input');
                    const amountInput = row.querySelector('.amount-input');
                    const tickerRaw = tickerInput.value.trim();
                    const amount = parseFloat(amountInput.value);

                    if (tickerRaw && !isNaN(amount) && amount > 0) {
                        let ticker = tickerRaw;
                        if (ticker.toLowerCase() === 'cash') {
                            ticker = 'Cash';
                        } else {
                            ticker = ticker.toUpperCase();
                            if (symbolToTickerMap[ticker]) {
                                ticker = symbolToTickerMap[ticker];
                            }
                        }
                        myPortfolio[ticker] = (myPortfolio[ticker] || 0) + amount;
                        totalValue += amount;
                    }
                });

                if (totalValue === 0) {
                    alert("ìœ íš¨í•œ ë³´ìœ ìì‚°ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                    return;
                }

                const myPortfolioWeights = {};
                for (const ticker in myPortfolio) {
                    myPortfolioWeights[ticker] = myPortfolio[ticker] / totalValue;
                }

                const recommended = coinStrategyPortfolio || {};
                const allAssets = new Set([...Object.keys(myPortfolioWeights), ...Object.keys(recommended)]);
                let turnover = 0;

                let resultHtml = '<h3>í¬íŠ¸í´ë¦¬ì˜¤ ë¹„êµ</h3>';
                resultHtml += '<table class="small-table"><thead><tr><th>ìì‚°</th><th>ë‚´ ë¹„ì¤‘</th><th>ì¶”ì²œ ë¹„ì¤‘</th><th>ì°¨ì´</th></tr></thead><tbody>';

                const sortedAssets = Array.from(allAssets).sort();

                sortedAssets.forEach(asset => {
                    const myWeight = myPortfolioWeights[asset] || 0;
                    const recommendedWeight = recommended[asset] || 0;
                    const diff = Math.abs(myWeight - recommendedWeight);
                    turnover += diff;

                    resultHtml += `
                        <tr>
                            <td>${asset}</td>
                            <td>${(myWeight * 100).toFixed(2)}%</td>
                            <td>${(recommendedWeight * 100).toFixed(2)}%</td>
                            <td>${(diff * 100).toFixed(2)}%</td>
                        </tr>
                    `;
                });
                
                turnover = turnover / 2;

                resultHtml += '</tbody></table>';
                resultHtml += `<h3>ğŸ”„ ê³„ì‚°ëœ í„´ì˜¤ë²„: <strong>${(turnover * 100).toFixed(2)}%</strong></h3>`;
                resultHtml += '<p>í„´ì˜¤ë²„ëŠ” í˜„ì¬ í¬íŠ¸í´ë¦¬ì˜¤ì—ì„œ ì¶”ì²œ í¬íŠ¸í´ë¦¬ì˜¤ë¡œ ë³€ê²½í•˜ê¸° ìœ„í•´ ë§¤ë§¤í•´ì•¼ í•  ìì‚°ì˜ ë¹„ìœ¨ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</p>';

                document.getElementById('my-turnover-result').innerHTML = resultHtml;
                document.getElementById('my-turnover-result-container').style.display = 'block';
            });
        </script>
    </body>
    </html>
    